{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Enemy Unit",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique ID of this enemy",
      "ui": { "widget": "hidden" }
    },
    "slug": {
      "type": "string",
      "ui": { "widget": "text", "label": "ID/Slug" }
    },
    "name": {
      "type": "string",
      "ui": { "widget": "text", "label": "Name" }
    },
    "type": {
      "type": "string",
      "enum": ["beast", "undead", "humanoid", "elemental", "machine", "boss", "demon", "dragon", "giant", "spirit", "other"],
      "ui": { "widget": "select", "label": "Enemy Type" }
    },
    "level": {
      "type": "number",
      "ui": { "widget": "number", "label": "Level" }
    },
    "description": {
      "type": "string",
      "ui": { "widget": "textarea", "label": "Lore / Description" }
    },
    "image_path": {
      "type": "string",
      "ui": { "widget": "filepicker", "label": "Image" }
    },
    "class_id": {
      "type": "string",
      "description": "Base class template (optional)",
      "ui": {
        "widget": "reference",
        "label": "Combat Class",
        "reference": "characterclasses"
      }
    },
    "custom_stats": {
      "type": "object",
      "description": "Override class stats (optional)",
      "properties": {
        "hp": { "type": "number" },
        "attack": { "type": "number" },
        "defense": { "type": "number" },
        "speed": { "type": "number" },
        "mana": { "type": "number" },
        "spell_power": { "type": "number" }
      }
    },
    "custom_abilities": {
      "type": "array",
      "description": "Override or add abilities",
      "items": { "type": "string" },
      "ui": {
        "widget": "multiselect",
        "label": "Abilities",
        "reference": "abilities"
      }
    },
    "faction_id": {
      "type": "string",
      "ui": {
        "widget": "reference",
        "label": "Faction",
        "reference": "factions"
      }
    },
    "aggression": {
      "type": "string",
      "enum": ["Hostile", "Neutral", "Friendly"],
      "ui": { "widget": "select", "label": "Aggression" }
    },
    "tags": {
      "type": "array",
      "description": "Tags for filtering/searching/categorisation",
      "items": { "type": "string" },
      "ui": { "widget": "tags", "label": "Tags" }
    },
    "loot_table": {
      "type": "array",
      "items": {
        "type": "object",
        "properties": {
          "item_id": {
            "type": "string",
            "ui": {
              "widget": "reference",
              "reference": "items",
              "label": "Item"
            }
          },
          "drop_chance": {
            "type": "number",
            "ui": { "widget": "number", "label": "Drop Chance" }
          }
        },
        "required": ["item_id", "drop_chance"]
      },
      "ui": { "widget": "item_drop_table", "label": "Loot" }
    },
    "currency_rewards": {
      "type": "array",
      "description": "Currency drops with optional drop chance",
      "items": {
        "type": "object",
        "properties": {
          "currency_id": {
            "type": "string",
            "ui": {
              "widget": "reference",
              "reference": "currencies",
              "label": "Currency"
            }
          },
          "amount": {
            "type": "number",
            "ui": { "widget": "number", "label": "Amount" }
          },
          "drop_chance": {
            "type": "number",
            "description": "0-1 chance for this reward to drop",
            "ui": { "widget": "number", "label": "Drop Chance" }
          }
        },
        "required": ["currency_id", "amount"]
      }
    },
    "reputation_rewards": {
      "type": "array",
      "description": "Faction reputation adjustments granted on defeat",
      "items": {
        "type": "object",
        "properties": {
          "faction_id": {
            "type": "string",
            "ui": {
              "widget": "reference",
              "reference": "factions",
              "label": "Faction"
            }
          },
          "amount": {
            "type": "number",
            "description": "Positive or negative reputation delta",
            "ui": { "widget": "number", "label": "Delta" }
          },
          "drop_chance": {
            "type": "number",
            "description": "Optional probability applied before the change",
            "ui": { "widget": "number", "label": "Drop Chance" }
          }
        },
        "required": ["faction_id", "amount"]
      }
    },
    "xp_reward": {
      "type": "number",
      "description": "Experience awarded for defeating the enemy",
      "ui": { "widget": "number", "label": "Experience" }
    },
    "related_quests": {
      "type": "array",
      "items": { "type": "string" },
      "ui": {
        "widget": "multiselect",
        "label": "Related Quests",
        "reference": "quests"
      }
    }
  },
  "required": ["id", "slug", "name", "level"]
}
