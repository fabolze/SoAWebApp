{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Item",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "ui": {
        "widget": "hidden"
      }
    },
    "slug": {
      "type": "string",
      "ui": {
        "widget": "text",
        "label": "ID/Slug"
      }
    },
    "name": {
      "type": "string",
      "ui": {
        "widget": "text",
        "label": "Item Name"
      }
    },
    "type": {
      "type": "string",
      "enum": [
        "Weapon",
        "Armor",
        "Accessory",
        "Consumable",
        "Tool",
        "Material",
        "Upgrade",
        "Quest",
        "SetPiece",
        "Misc"
      ],
      "ui": {
        "widget": "select",
        "label": "Item Type",
        "options": [
          "Weapon",
          "Armor",
          "Accessory",
          "Consumable",
          "Tool",
          "Material",
          "Upgrade",
          "Quest",
          "SetPiece",
          "Misc"
        ]
      }
    },
    "rarity": {
      "type": "string",
      "enum": [
        "Common",
        "Uncommon",
        "Rare",
        "Epic",
        "Legendary"
      ],
      "ui": {
        "widget": "select",
        "label": "Rarity"
      }
    },
    "description": {
      "type": "string",
      "ui": {
        "widget": "textarea",
        "label": "Description"
      }
    },
    "base_price": {
      "type": "number",
      "description": "Canonical value used as the baseline for shop pricing",
      "ui": {
        "widget": "number",
        "label": "Base Price"
      }
    },
    "base_currency_id": {
      "type": "string",
      "description": "Optional: currency for the base price (defaults to global currency if omitted)",
      "ui": {
        "widget": "reference",
        "reference": "currencies",
        "label": "Base Currency"
      }
    },
    "equipment_slot": {
      "type": "string",
      "enum": [
        "head",
        "chest",
        "legs",
        "feet",
        "hands",
        "belt",
        "ring",
        "amulet",
        "back",
        "main_hand",
        "off_hand",
        "two_hand",
        "accessory",
        "mount",
        "pet"
      ],
      "ui": {
        "widget": "select",
        "label": "Equipment Slot",
        "visible_if": {
          "type": [
            "Weapon",
            "Armor",
            "Accessory",
            "SetPiece",
            "Tool"
          ]
        }
      }
    },
    "weapon_type": {
      "type": "string",
      "enum": [
        "Greatsword",
        "Longsword",
        "Shortsword",
        "Dagger",
        "Rapier",
        "Axe",
        "Greataxe",
        "Hammer",
        "Mace",
        "Spear",
        "Polearm",
        "Halberd",
        "Staff",
        "Wand",
        "Tome",
        "Bow",
        "Crossbow",
        "Firearm",
        "Thrown",
        "Unarmed",
        "Shield",
        "Focus",
        "Instrument"
      ],
      "ui": {
        "widget": "select",
        "label": "Weapon Type",
        "visible_if": {
          "type": [
            "Weapon"
          ]
        }
      }
    },
    "damage_type": {
      "type": "string",
      "enum": [
        "Slashing",
        "Piercing",
        "Blunt",
        "Fire",
        "Water",
        "Air",
        "Earth",
        "Poison",
        "Psychic",
        "Light",
        "Shadow"
      ],
      "ui": {
        "widget": "select",
        "label": "Damage Type",
        "visible_if": {
          "type": [
            "Weapon"
          ]
        }
      }
    },
    "weapon_range_type": {
      "type": "string",
      "enum": [
        "melee",
        "range"
      ],
      "ui": {
        "widget": "select",
        "label": "Weapon Range Type",
        "visible_if": {
          "type": [
            "Weapon"
          ]
        }
      }
    },
    "weapon_range": {
      "type": "integer",
      "ui": {
        "widget": "number",
        "label": "Weapon Range",
        "visible_if": {
          "type": [
            "Weapon"
          ]
        }
      }
    },
    "stat_modifiers": {
      "type": "array",
      "description": "List of stat bonuses or penalties applied while the item is equipped",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "ui": {
              "widget": "hidden"
            }
          },
          "stat_id": {
            "type": "string",
            "ui": {
              "widget": "reference",
              "reference": "stats",
              "label": "Stat"
            }
          },
          "value": {
            "type": "number",
            "ui": {
              "widget": "number",
              "label": "Value"
            }
          },
          "value_type": {
            "type": "string",
            "enum": [
              "Flat",
              "Percentage",
              "Multiplier"
            ],
            "ui": {
              "widget": "select",
              "label": "Value Type",
              "description": "Flat applies raw value, Percentage multiplies current stat, Multiplier stacks multiplicatively"
            }
          },
          "scaling_behavior": {
            "type": "string",
            "enum": [
              "None",
              "Linear",
              "Exponential",
              "Logarithmic",
              "Custom"
            ],
            "ui": {
              "widget": "select",
              "label": "Scaling Behavior",
              "options": [
                "None",
                "Linear",
                "Exponential",
                "Logarithmic",
                "Custom"
              ]
            }
          },
          "notes": {
            "type": "string",
            "ui": {
              "widget": "textarea",
              "label": "Designer Notes"
            }
          }
        },
        "required": [
          "stat_id",
          "value"
        ]
      },
      "ui": {
        "label": "Stat Modifiers",
        "description": "Define each stat this item modifies. Use value type and scaling to control how the bonus interacts with character growth."
      }
    },
    "attribute_modifiers": {
      "type": "array",
      "description": "Attribute bonuses granted while equipped",
      "items": {
        "type": "object",
        "properties": {
          "id": {
            "type": "string",
            "ui": {
              "widget": "hidden"
            }
          },
          "attribute_id": {
            "type": "string",
            "ui": {
              "widget": "reference",
              "reference": "attributes",
              "label": "Attribute"
            }
          },
          "value": {
            "type": "number",
            "ui": {
              "widget": "number",
              "label": "Value"
            }
          },
          "scaling": {
            "type": "string",
            "enum": [
              "None",
              "Linear",
              "Exponential",
              "Logarithmic",
              "Custom"
            ],
            "ui": {
              "widget": "select",
              "label": "Scaling"
            }
          },
          "notes": {
            "type": "string",
            "ui": {
              "widget": "textarea",
              "label": "Designer Notes"
            }
          }
        },
        "required": [
          "attribute_id",
          "value"
        ]
      },
      "ui": {
        "label": "Attribute Modifiers",
        "description": "Optional attribute bonuses that feed into downstream stat calculations."
      }
    },
    "effects": {
      "type": "array",
      "items": {
        "type": "string"
      },
      "ui": {
        "widget": "multiselect",
        "label": "Effects",
        "options_source": "schemas/effects.json"
      }
    },
    "requirements_id": {
      "type": "string",
      "description": "Requirement to use this item",
      "ui": {
        "widget": "reference",
        "reference": "requirements",
        "label": "Requirements"
      }
    },
    "icon_path": {
      "type": "string",
      "description": "Optional icon for this item",
      "ui": {
        "widget": "filepicker",
        "label": "Icon"
      }
    },
    "tags": {
      "type": "array",
      "description": "Tags for filtering/searching/categorization",
      "items": {
        "type": "string"
      },
      "ui": {
        "widget": "tags",
        "label": "Tags"
      }
    }
  },
  "required": [
    "id",
    "slug",
    "name",
    "type",
    "base_price"
  ]
}
