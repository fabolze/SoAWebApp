{
  "$schema": "http://json-schema.org/draft-07/schema#",
  "title": "Encounter",
  "type": "object",
  "properties": {
    "id": {
      "type": "string",
      "description": "Unique ID for the encounter",
      "ui": { "widget": "hidden" }
    },
    "slug": {
      "type": "string",
      "ui": { "widget": "text", "label": "ID/Slug" }
    },
    "name": {
      "type": "string",
      "description": "Name of the encounter (internal or for UI)",
      "ui": { "widget": "text", "label": "Name" }
    },
    "description": {
      "type": "string",
      "description": "Optional description of the encounter (for devs)",
      "ui": { "widget": "textarea", "label": "Description" }
    },
    "encounter_type": {
      "type": "string",
      "description": "Type of encounter",
      "enum": ["Combat", "Dialogue", "Event"],
      "ui": {
        "widget": "select",
        "label": "Encounter Type",
        "options": ["Combat", "Dialogue", "Event"]
      }
    },
    "requirements_id": {
      "type": "string",
      "description": "Requirement to unlock this encounter",
      "ui": {
        "widget": "reference",
        "reference": "requirements",
        "label": "Requirements"
      }
    },
    "enemy_ids": {
      "type": "array",
      "description": "List of enemy IDs to spawn (if combat)",
      "items": { "type": "string" },
      "ui": {
        "widget": "multiselect",
        "label": "Enemies",
        "reference": "enemies"
      }
    },
    "npc_ids": {
      "type": "array",
      "description": "List of NPC IDs involved (optional)",
      "items": { "type": "string" },
      "ui": {
        "widget": "multiselect",
        "label": "NPCs",
        "reference": "npcs"
      }
    },
    "rewards": {
      "type": "object",
      "description": "Rewards granted after completing the encounter",
      "properties": {
        "xp": {
          "type": "number",
          "description": "Experience points granted to the player",
          "ui": { "widget": "number", "label": "Experience" }
        },
        "items": {
          "type": "array",
          "description": "Items granted with the reward",
          "items": {
            "type": "object",
            "properties": {
              "item_id": {
                "type": "string",
                "ui": {
                  "widget": "reference",
                  "reference": "items",
                  "label": "Item"
                }
              },
              "quantity": {
                "type": "number",
                "ui": { "widget": "number", "label": "Quantity" }
              }
            },
            "required": ["item_id", "quantity"]
          }
        },
        "currencies": {
          "type": "array",
          "description": "Currency rewarded to the player",
          "items": {
            "type": "object",
            "properties": {
              "currency_id": {
                "type": "string",
                "ui": {
                  "widget": "reference",
                  "reference": "currencies",
                  "label": "Currency"
                }
              },
              "amount": {
                "type": "number",
                "ui": { "widget": "number", "label": "Amount" }
              }
            },
            "required": ["currency_id", "amount"]
          }
        },
        "reputation": {
          "type": "array",
          "description": "Faction reputation adjustments",
          "items": {
            "type": "object",
            "properties": {
              "faction_id": {
                "type": "string",
                "ui": {
                  "widget": "reference",
                  "reference": "factions",
                  "label": "Faction"
                }
              },
              "amount": {
                "type": "number",
                "description": "Positive or negative reputation delta",
                "ui": { "widget": "number", "label": "Delta" }
              }
            },
            "required": ["faction_id", "amount"]
          }
        },
        "flags_set": {
          "type": "array",
          "description": "Flags set after completing the encounter",
          "items": { "type": "string" },
          "ui": {
            "widget": "multiselect",
            "label": "Flags Set",
            "reference": "flags"
          }
        }
      }
    },
    "tags": {
      "type": "array",
      "description": "Tags for filtering/searching/categorisation",
      "items": { "type": "string" },
      "ui": { "widget": "tags", "label": "Tags" }
    }
  },
  "required": ["id", "slug", "name", "encounter_type"]
}
